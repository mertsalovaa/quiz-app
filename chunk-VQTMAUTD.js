import{a as Ie,b as Te}from"./chunk-TB7LUMOS.js";import"./chunk-SOCHOKZM.js";import{a as Me,c as Ae}from"./chunk-N3ZTD2TR.js";import{$ as n,A as D,Aa as O,Ba as A,C as te,Ca as le,Da as pe,G as d,Ha as me,J as C,Ja as de,K as I,La as k,Na as ce,Oa as ue,P as x,Pa as fe,Qa as ge,Ra as ve,Sa as he,T as ie,Ta as xe,U as r,Ua as we,V as S,Va as be,X as w,Xa as ye,Y as p,Ya as v,Za as $,_a as Se,aa as a,ba as c,bb as F,c as y,ca as R,cb as _e,da as q,db as Ce,ea as E,f as U,fa as f,ga as b,h,i as J,ja as K,ka as oe,l as ee,la as ne,ma as re,n as Y,na as s,oa as m,pa as z,ra as ae,ua as T,va as M,za as se}from"./chunk-R2VOVZNE.js";import{a as N,b as Z}from"./chunk-AIZVJUQQ.js";var $e={10:"Amazing job! You mastered the test like a pro! \u{1F389}",8:"Great work! You're doing very well. Keep it up! \u{1F4AA}",6:"Good effort! You have solid knowledge. Keep learning! \u{1F4DA}",4:"You're halfway there! A bit more effort and you'll shine. \u2728",0:"It's a start! Review the material and try again. \u{1F331}"};function Ee(o){let e=Object.keys($e).map(Number).sort((t,i)=>i-t).find(t=>o>=t);return $e[e??0]}var g={title:"Leave quiz",page:"main page",link:"/main",text:"Are you sure you want to exit and cancel the quiz? Your answers will not be saved."},Ne={"/quizzes-catalog":{title:g.title,text:g.text,page:"quizzes catalog",link:"/quizzes-catalog"},"/statistics":{title:g.title,text:g.text,page:"statistics",link:"/statistics"},refresh:{page:"new quiz session",link:"",title:"Refresh page",text:`Do you want to refresh your quiz?
 Your current result will be lost`},"/finish":{page:"statistics",link:"/statistics",title:"Finish quiz",text:"To get your quiz result, please, confirm this action and go to the page with the conclusion."},"/quiz/0":{page:"quiz",link:"/quiz/0",title:g.title,text:g.text},"":N({},g)};var W=class o{constructor(e){this.router=e}modalState$=new y({visibility:!1,choice:!1,data:g});get modalWindowState$(){return this.modalState$.getValue().visibility}get modalWindowData$(){return this.modalState$.asObservable().pipe(h(e=>e.data))}setModalData(e){let t=e.trim();return Ne[t]||g}setModalState(e){let t=this.setModalData(e);this.modalState$.next({visibility:!0,choice:!1,data:t})}handleModalAction(e){if(e){this.modalState$.next(Z(N({},this.modalState$.getValue()),{choice:!0}));let t=this.modalState$.getValue().data.link;t==="refresh"?window.location.reload():t==="/finish"?this.router.navigateByUrl("/statistics"):this.router.navigateByUrl(t)}else this.closeModal()}closeModal(){this.modalState$.next({visibility:!1,choice:!1,data:g})}static \u0275fac=function(t){return new(t||o)(te(k))};static \u0275prov=D({token:o,factory:o.\u0275fac,providedIn:"root"})};var j=class o{startTime=0;timer;get updateElapsedTime(){return Math.floor((Date.now()-this.startTime)/1e3)}startTest(){this.startTime=Date.now(),this.timer=setInterval(()=>{this.updateElapsedTime},1e3)}finishTest(){return clearInterval(this.timer),this.updateElapsedTime}formatTime(e){let t=Math.floor(e/60),i=e%60;return t>0?`${t} min ${i} sec`:`${i} sec`}static \u0275fac=function(t){return new(t||o)};static \u0275prov=D({token:o,factory:o.\u0275fac,providedIn:"root"})};var V=class o{text="";control;static \u0275fac=function(t){return new(t||o)};static \u0275cmp=d({type:o,selectors:[["app-ui-radio-button"]],inputs:{text:"text",control:"control"},decls:5,vars:7,consts:[[1,"radio","flex","items-center","m-1.5"],["name","radio","type","radio",1,"opacity-0","absolute","peer",3,"id","value","formControl"],[1,"radio__label","flex","before:radio-before","hover:cursor-pointer","peer-checked:text-bright","peer-focus:text-bright","peer-focus:before:border-error","peer-focus:before:outline-none","peer-checked:radio-before-checked",3,"for"]],template:function(t,i){t&1&&(n(0,"span",0),c(1,"input",1),n(2,"label",2)(3,"app-ui-typography"),s(4),a()()()),t&2&&(r(),K("id","radio-",i.text,""),p("value",i.text)("formControl",i.control),r(),K("for","radio-",i.text,""),r(2),m(i.text))},dependencies:[ue,we,ge,be,v],encapsulation:2})};var P=class o{message="Please select an option to continue the quiz";static \u0275fac=function(t){return new(t||o)};static \u0275cmp=d({type:o,selectors:[["app-ui-notification"]],decls:3,vars:1,consts:[[1,"flex","items-center","fixed","right-4","bottom-4","p-3","pr-5","bg-error/90","text-shade","border-2","border-error","rounded","z-10"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"app-ui-typography"),s(2),a()()),t&2&&(r(2),m(i.message))},dependencies:[v],encapsulation:2})};function Ve(o,e){if(o&1&&(R(0),c(1,"app-ui-radio-button",3),q()),o&2){let t=e.$implicit,i=b();r(),p("text",t)("control",i.formControl)}}function Be(o,e){o&1&&c(0,"app-ui-notification",4)}var G=class o{getSelectedAnswer=new x;options=[];set setFormControl(e){this.formControl.setValue(e,{emitEvent:!1})}subscription;isNotification$=new y(!1);formControl=new he("",fe.required);value=null;isSelectedAnswer(){return this.formControl.invalid?(this.isNotification$.next(!0),setTimeout(()=>{this.isNotification$.next(!1)},1500),this.formControl.markAsTouched(),!1):!0}ngOnInit(){this.subscription=this.formControl.valueChanges.subscribe(e=>{this.getSelectedAnswer.emit(e)})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=d({type:o,selectors:[["app-ui-radio-group"]],inputs:{options:"options",setFormControl:"setFormControl"},outputs:{getSelectedAnswer:"getSelectedAnswer"},decls:3,vars:2,consts:[[1,"radio-group","flex","flex-col","max-md:items-start","lg:items-start"],[4,"ngFor","ngForOf"],["class","absolute inset-2",4,"ngIf"],[3,"text","control"],[1,"absolute","inset-2"]],template:function(t,i){t&1&&(n(0,"div",0),w(1,Ve,2,2,"ng-container",1),a(),w(2,Be,1,0,"app-ui-notification",2)),t&2&&(r(),p("ngForOf",i.options),r(),p("ngIf",i.isNotification$.value))},dependencies:[O,A,V,P],encapsulation:2})};var Ge=["radioGroup"];function Le(o,e){if(o&1&&(R(0),c(1,"svg-icon",20),q()),o&2){let t=e.$implicit;r(),p("src",t)}}function He(o,e){if(o&1){let t=E();n(0,"app-ui-button",21),f("click",function(){C(t);let l=b();return I(l.handlePrev())}),n(1,"span",18),s(2),a(),n(3,"span",19),s(4),a()()}if(o&2){let t=b();r(2),m(t.buttonTextLg.prev),r(2),m(t.buttonTextSm.prev)}}var L=class o{item={question:"",type:!1,difficulty:"",category:"",correct_answer:"",incorrect_answers:[]};options=new Array(_e);id=0;selectedAnswer="";next=new x;prev=new x;getSelectedAnswer=new x;radioGroup;size=F;images=["avatars/Profile-1.svg","avatars/Profile-2.svg","avatars/Profile.svg"];setSelectedAnswer(e){this.getSelectedAnswer.emit(e)}get buttonTextLg(){return{prev:"Prev question",next:this.id===this.size?"Finish":"Next question"}}get buttonTextSm(){return{prev:"Prev",next:this.id===this.size?"Finish":"Next"}}handlePrev(){this.prev.emit()}handleNext(){this.radioGroup.isSelectedAnswer()&&this.next.emit()}getFormattedText(){let e=this.item.question,t=Math.floor(e.length/Ce),i=e.indexOf(" ",t),l=i+1,u=e.lastIndexOf(" ",e.length-t);return{start:e.slice(0,i),middle:e.slice(l,u),end:e.slice(u)}}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=d({type:o,selectors:[["app-ui-question-item"]],viewQuery:function(t,i){if(t&1&&oe(Ge,5),t&2){let l;ne(l=re())&&(i.radioGroup=l.first)}},inputs:{item:"item",options:"options",id:"id",selectedAnswer:"selectedAnswer"},outputs:{next:"next",prev:"prev",getSelectedAnswer:"getSelectedAnswer"},decls:28,vars:13,consts:[["radioGroup",""],[1,"bg-success","px-7","py-10","rounded-3xl","flex","flex-col","items-center","justify-between","lg:min-h-[550px]"],[1,"w-full","flex","items-start","justify-between"],[1,"flex","items-center"],["type","H5","highlightText","framed","highlightColor","bg-warning"],["type","P1",1,"text-bright","ml-2"],[1,"flex"],[4,"ngFor","ngForOf"],["type","H6",1,"w-full","flex","justify-start","text-bright/90","underline","underline-offset-4","pt-3"],[1,"w-full","flex","text-bright","items-center","justify-start","flex-wrap","*:mr-2","py-6"],["type","H4",1,"mr-2"],["type","H4","highlightText","framed","highlightColor","bg-error"],["type","H4"],[1,"max-md:w-full","lg:min-w-2/5"],[3,"getSelectedAnswer","options","setFormControl"],[1,"flex","items-center","w-full","pt-10",3,"ngClass"],["class","*:bg-accent/15","type","ghost","iconState","prev",3,"click",4,"ngIf"],["type","accent","iconState","next",3,"click"],[1,"max-sm:hidden","sm:block"],[1,"max-sm:block","sm:hidden"],["svgClass","lg:w-20 lg:h-20 max-lg:w-16 max-lg:h-16 object-cover",3,"src"],["type","ghost","iconState","prev",1,"*:bg-accent/15",3,"click"]],template:function(t,i){if(t&1){let l=E();n(0,"div",1)(1,"div",2)(2,"span",3)(3,"app-ui-typography",4),s(4),a(),n(5,"app-ui-typography",5),s(6),a()(),n(7,"span",6),w(8,Le,2,1,"ng-container",7),a()(),n(9,"app-ui-typography",8),s(10),a(),n(11,"span",9)(12,"app-ui-typography",10),s(13),a(),n(14,"app-ui-typography",11),s(15),a(),n(16,"app-ui-typography",12),s(17),a()(),n(18,"form",13)(19,"app-ui-radio-group",14,0),f("getSelectedAnswer",function(X){return C(l),I(i.setSelectedAnswer(X))}),a()(),n(21,"div",15),w(22,He,5,2,"app-ui-button",16),n(23,"app-ui-button",17),f("click",function(){return C(l),I(i.handleNext())}),n(24,"span",18),s(25),a(),n(26,"span",19),s(27),a()()()()}t&2&&(r(4),m(i.id),r(2),z("/",i.size,""),r(2),p("ngForOf",i.images),r(2),m(i.item.category),r(3),m(i.getFormattedText().start),r(2),m(i.getFormattedText().middle),r(2),m(i.getFormattedText().end),r(2),p("options",i.options)("setFormControl",i.selectedAnswer),r(2),p("ngClass",i.id==1?"justify-end":"justify-between"),r(),p("ngIf",i.id!=1),r(3),m(i.buttonTextLg.next),r(2),m(i.buttonTextSm.next))},dependencies:[se,O,A,ce,xe,ve,$,v,G],encapsulation:2})};var H=class o{confirm=new x;data={page:"",link:"",text:"",title:""};onConfirm(){this.confirm.emit(!0)}onCancel(){this.confirm.emit(!1)}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=d({type:o,selectors:[["app-ui-modal-window"]],inputs:{data:"data"},outputs:{confirm:"confirm"},decls:16,vars:3,consts:[["aria-labelledby","modal-title","role","dialog","aria-modal","true",1,"relative","z-[1002]"],["aria-hidden","true",1,"fixed","inset-0","bg-muted/75","transition-opacity","no-doc-scroll"],[1,"fixed","inset-x-0","top-1/4","z-10","w-screen","overflow-y-auto"],[1,"flex","min-h-full","items-end","justify-center","p-4","text-center","sm:items-center","sm:p-0"],[1,"relative","transform","overflow-hidden","rounded-xl","border-accent","border-4","bg-bright","text-left","shadow-xl","transition-all","lg:max-w-lg","max-md:max-w-sm","p-10","flex","flex-col","items-center"],[1,"flex","flex-col","items-center","text-center","w-full","*:py-1.5"],["type","H6"],["type","P1"],[1,"flex","max-md:flex-col","items-center","*:p-0.5"],["type","accent",3,"click"],["type","ghost",1,"*:text-accent",3,"click"]],template:function(t,i){t&1&&(n(0,"div",0),c(1,"div",1),n(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"app-ui-typography",6),s(7),a(),n(8,"app-ui-typography",7),s(9),a(),c(10,"div"),a(),n(11,"div",8)(12,"app-ui-button",9),f("click",function(){return i.onCancel()}),s(13,"Back to quiz"),a(),n(14,"app-ui-button",10),f("click",function(){return i.onConfirm()}),s(15),a()()()()()()),t&2&&(r(7),m(i.data.title),r(2),m(i.data.text),r(6),z("Go to ",i.data.page,""))},dependencies:[$,v],encapsulation:2})};function Ke(o,e){if(o&1){let t=E();n(0,"app-ui-modal-window",11),T(1,"async"),f("confirm",function(l){C(t);let u=b();return I(u.handleModalResponse(l))}),a()}if(o&2){let t=b();p("data",M(1,1,t.modalWindowData$))}}var qe=class o{constructor(e,t,i,l,u,X){this.activeRoute=e;this.router=t;this.storeService=i;this.modalService=l;this.timeService=u;this.statisticService=X}unloadNotification(e){this.modalService.modalState$.getValue()?.choice||(e.preventDefault(),this.nextRoute="refresh")}quiz="";nextRoute="";questions$;isLoading$;currentIndex$=new y(0);currentQuestion$;answers$=new y([]);modalWindowState$;modalWindowData$;get options(){return this.currentQuestion$.pipe(Y(1),h(e=>[...e.incorrect_answers,e.correct_answer].sort().reverse()))}get id(){return this.currentIndex$.value+1}canDeactivate(){return this.answers$.getValue()[0]===void 0?U(!0):this.modalService.modalState$.getValue().choice?(this.modalService.closeModal(),U(!0)):(this.modalService.setModalState(this.nextRoute),this.modalService.modalState$.pipe(Y(1),h(e=>e.choice)))}ngOnInit(){this.quiz=this.activeRoute.snapshot.params.id,this.questions$=this.storeService.getQuestions(),this.isLoading$=this.storeService.getLoadingQuestions(),this.storeService.loadQuestions(Number.parseInt(this.quiz)),this.modalWindowData$=this.modalService.modalState$.pipe(h(e=>e.data)),this.modalWindowState$=this.modalService.modalState$.pipe(h(e=>e.visibility)),this.currentQuestion$=J([this.questions$,this.currentIndex$]).pipe(h(([e,t])=>{let i=e?.[t]||{question:"",type:!1,difficulty:"",category:"",correct_answer:"",incorrect_answers:[]};return Me(i)})),this.timeService.startTest(),this.handleNavigation()}handleModalResponse(e){if(e===!0&&this.nextRoute==="/finish"){let t=this.timeService.finishTest(),i=this.statisticService.initScore(this.questions$,this.answers$.getValue()),l={seconds:t,formattedTime:this.timeService.formatTime(t),score:i,resultText:Ee(i)};this.statisticService.initResult(l)}this.modalService.handleModalAction(e)}nextQuestion(){let e=this.currentIndex$.value;e<F-1?this.currentIndex$.next(e+1):this.router.navigateByUrl("/finish")}prevQuestion(){let e=this.currentIndex$.value;e>0&&this.currentIndex$.next(e-1)}setSelectedAnswer(e){this.answers$.getValue()[this.currentIndex$.value]=e}handleNavigation(){this.router.events.pipe(ee(e=>e instanceof me),h(e=>e.url)).subscribe(e=>{this.nextRoute=e})}static \u0275fac=function(t){return new(t||o)(S(de),S(k),S(Ie),S(W),S(j),S(Ae))};static \u0275cmp=d({type:o,selectors:[["app-quiz"]],hostBindings:function(t,i){t&1&&f("beforeunload",function(u){return i.unloadNotification(u)},!1,ie)},inputs:{quiz:"quiz"},standalone:!0,features:[ae],decls:20,vars:14,consts:[[1,"absolute","inset-x-0","top","flex","flex-col","items-center","justify-between","min-h-fit","w-full","bg-primary","pb-8"],[1,"first:text-bright","flex","items-center","*:p-1.5","pb-3","flex-wrap","justify-center","text-center","w-3/4"],["type","H2"],["type","H3"],["type","H2","highlightText","ellipse"],["type","P1",1,"text-bright","lg:w-3/12","max-md:w-9/12","pb-5","text-center","flex","justify-center"],["link","/quizzes-catalog",1,"lg:absolute","lg:left-3","mb-4"],["size","md","type","accent","iconState","prev"],[1,"lg:w-1/2","md:w-2/3","max-md:w-10/12",3,"next","prev","getSelectedAnswer","id","item","options","selectedAnswer"],[3,"show"],[3,"data","confirm",4,"ngIf"],[3,"confirm","data"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"div",1)(2,"app-ui-typography",2),s(3,"Emoji Bands "),a(),n(4,"app-ui-typography",3),s(5,"Quiz"),a(),n(6,"app-ui-typography",4),s(7,"."),a()(),n(8,"app-ui-typography",5),s(9,"Can you decipher these emoji clues to answer these music-related questions?"),a(),n(10,"app-ui-link",6)(11,"app-ui-button",7),s(12,"Go to catalog"),a()(),n(13,"app-ui-question-item",8),T(14,"async"),T(15,"async"),f("next",function(){return i.nextQuestion()})("prev",function(){return i.prevQuestion()})("getSelectedAnswer",function(u){return i.setSelectedAnswer(u)}),a()(),c(16,"app-ui-spinner",9),T(17,"async"),w(18,Ke,2,3,"app-ui-modal-window",10),T(19,"async")),t&2&&(r(13),p("id",i.id)("item",M(14,6,i.currentQuestion$))("options",M(15,8,i.options))("selectedAnswer",i.answers$.getValue()[i.currentIndex$.value]),r(3),p("show",!!M(17,10,i.isLoading$)),r(2),p("ngIf",M(19,12,i.modalWindowState$)))},dependencies:[ye,$,v,Se,Te,L,H,pe,A,le],encapsulation:2})};export{qe as QuestionComponent};
